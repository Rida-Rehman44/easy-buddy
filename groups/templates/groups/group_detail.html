<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ group.name }} - Group Detail</title>
    <!-- Add any necessary CSS or JavaScript imports -->
    <style>
        /* Add CSS styling for the map container */
        #map {
            height: 400px;
            width: 100%;
        }
    </style>
</head>
<body>
    <h1>{{ group.name }}</h1>
    <p><strong>Location:</strong> {{ group.location }}</p>
    <p><strong>Description:</strong> {{ group.description }}</p>
    
    <!-- Chat App Placeholder -->
    <div id="chat-app">
        <h2>Chat Room</h2>
        <div id="chat-messages">
            <!-- Chat messages will be displayed here -->
        </div>
        <form id="chat-form">
            <input type="text" id="message-input" placeholder="Type your message...">
            <button type="submit">Send</button>
        </form>
    </div>

    <!-- Map Placeholder -->
    <h1>Map</h1>
    <div id="map"></div>
    
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>



    <!-- Shared Shopping List Placeholder -->
    <div id="shopping-list">
        <h2>Shopping Lists</h2>
        <ul>
            {% for shopping_list in shopping_lists %}
            <li>{{ shopping_list.name }}</li>
            {% endfor %}
        </ul>
            <li><a href="{% url 'groups:home_list'  %}">{{ membership.name }}</a></li>
        
        </div>
        <button onclick="redirectToShoppingChecklist()" class="btn btn-primary">Go to Shopping Checklist</button>
    <!-- Time Schedule App Placeholder -->
    

    <!-- Bulletin Board Placeholder -->
    <div id="bulletin-board">
        <h2>BulletinBoard</h2>
            <li><a href="{% url 'groups:bulletin_board'  %}">BulletinBoard</a></li>

        <!-- Add a button to create bulletin board messages -->
 
    </div>

    <!-- JavaScript for WebSocket connection -->
    <script>
        // Create a WebSocket connection
        const chatSocket = new WebSocket('ws://localhost:8000/ws/chat/');

        // Event handlers and message sending logic goes here...

        // Handle the connection being opened
        chatSocket.onopen = function(event) {
            console.log('WebSocket connection established');
        };

        // Handle incoming messages from the server
        chatSocket.onmessage = function(event) {
            const data = JSON.parse(event.data);
            // Display the received message in the chat interface
            const messageElement = document.createElement('div');
            messageElement.textContent = data.message;
            document.getElementById('chat-messages').appendChild(messageElement);
        };

        // Handle the connection being closed
        chatSocket.onclose = function(event) {
            console.log('WebSocket connection closed');
        };

        // Handle errors
        chatSocket.onerror = function(event) {
            console.error('WebSocket error:', event);
        };

        // Send a message when the user submits the form
        document.getElementById('chat-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const messageInput = document.getElementById('message-input');
            const message = messageInput.value.trim();
            if (message !== '') {
                // Send the message to the server
                chatSocket.send(JSON.stringify({ message: message }));
                // Clear the input field
                messageInput.value = '';
            }
        });

        // Add item to shopping list
        document.getElementById('add-item-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const itemInput = document.getElementById('item-input');
            const item = itemInput.value.trim();
            if (item !== '') {
                // Add the item to the list
                addItemToList(item);
                // Clear the input field
                itemInput.value = '';
            }
        });

        // Function to add item to the list
        function addItemToList(item) {
            const listItem = document.createElement('li');
            listItem.textContent = item;
            document.getElementById('list-items').appendChild(listItem);
        }

        // Function to redirect to home_list.html
        function redirectToShoppingChecklist() {
            window.location.href = "{% url 'groups:home_list' %}";
        }

        

    </script>
       <script src="https://maps.googleapis.com/maps/api/js?key={{ map_api_key }}&callback=initMap" async defer></script>

       <script>
           // JavaScript function to initialize the map
           function initMap() {
               // Replace these values with the latitude and longitude of the user's location
               var userLat = {{ user_location.latitude }};
               var userLng = {{ user_location.longitude }};
               
               // Create a map object centered at the user's location
               var map = new google.maps.Map(document.getElementById("map"), {
                   center: { lat: userLat, lng: userLng },
                   zoom: 15 // Adjust the zoom level as needed
               });
               
               // Create a marker at the user's location
               var marker = new google.maps.Marker({
                   position: { lat: userLat, lng: userLng },
                   map: map,
                   title: "User's Location"
               });
           }
       </script>

    <!-- Add a button to redirect to home_list.html -->
    
</body>
</html>
